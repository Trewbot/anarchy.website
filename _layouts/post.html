<!doctype html>
<html
    xmlns="http://www.w3.org/1999/xhtml"
    xml:lang="{{ page.lang | default: 'en' }}"
    lang="{{ page.lang | default: 'en' }}"
>
{%include head.html%}
<body>
    {%- include header.html -%}
    {%- if page.series -%}
        {%- assign ser = site.data.series[page.series] -%}
        {%- unless ser.type == "series" -%}
        <div class="series">
            {%- if ser.url -%}<a href="{{ser.url}}">{%- endif -%}
                {%- unless ser.no_em -%}<em>{%- endunless -%}
                  {{ser.title}}
                {%- unless ser.no_em -%}</em>{%- endunless -%}
            {%- if ser.url -%}</a>{%- endif -%}
            {%- if page.entry -%}
              &nbsp;&ndash;&nbsp;
              {%- if ser.set -%}{{ser.set}} {{page.set}},&nbsp;{%- endif -%}
              {%- if ser.entry -%}{{ser.entry}}&nbsp;{%- endif -%}{{page.entry}}
            {%- endif -%}
        </div>
        {%- endunless -%}
    {%- endif -%}
    {%- if page.image and page.replace_title -%}
        <img class="title-card" alt="{{page.title | strip_html}}" src="{{page.image}}"/>
    {%- else -%}
        <h1><!-- Sometimes strip_html simply isn't enough (like ruby text) -->
            {%- if page.stylized_title -%}
                {{page.stylized_title}}
            {%- else -%}
                {{page.title}}
            {%- endif -%}
        </h1>
    {%- endif -%}
    {%if page.subtitle%}
        <h3 class="subtitle">{{page.subtitle}}</h3>
    {%endif%}
    {%- if page.author and page.date -%}
        <div class="byline">
            {{ l10n_authors }}{{ l10n_date }}
        </div>
    {%- else -%}
        <hr/>
    {%- endif -%}
    <div class="content">
        {{content}}
    </div>
    {%- include navigation.html -%}
    <script>twemoji.parse(document.body, {
        //  Use SVG emojis
        folder: 'svg',
        ext: '.svg',
        callback: function(icon, op, variant){
            //  Emoji rendering exclusions
            //  (mostly text-like symbols that are better handled by the font)
            switch(icon){
                case '203c':    // Double exclamation
                case '2640':    // Female sign
                case '2642':    // Male sign
                case '26a7':    // Transgender sign
                case '3030':    // Wavy dash
                    return false;
            }
            return ''.concat(op.base, op.size, '/', icon, op.ext);
        }
    })</script>
    {%include footer.html%}
</body>
</html>
